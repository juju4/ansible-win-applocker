---

win_temp_dir: 'c:\Program Files\ansible'
win_log_dir: 'c:\ProgramData\ansible\log'

win_applocker_enable: true
win_applocker_policy: "applocker-basic.xml"
win_applocker_mode_exe: "AuditOnly"
#win_applocker_mode_exe: "Enabled"
win_applocker_mode_script: "AuditOnly"
win_applocker_mode_msi: "AuditOnly"
win_applocker_mode_appx: "AuditOnly"
win_applocker_mode_dll: "AuditOnly"

win_applocker_exe_rules_path:
  - Name: Allow Appveyor python
    Description: Appveyor/Cygwin python path for CI/CD integration
    UserGroup: S-1-1-0
    Action: Allow
    Path: '%OSDRIVE%\CYGWIN64\BIN\PYTHON3.6M.EXE'
  - Name: Deny runas access
    Description: https://blogs.technet.microsoft.com/jepayne/2016/04/04/when-the-manual-is-not-enough-runas-netonly-unexpected-credential-exposure-and-the-need-for-reality-based-holistic-threat-models/
    UserGroup: S-1-1-0
    Action: Deny
    Path: '%SYSTEM32%\runas.exe'
win_applocker_exe_rules_certificate: []
win_applocker_exe_rules_hash: []

# AppID service can only be started with a GPO, if standalone, using a scheduled task
win_insidedomain: false

win_testing_applocker: false
#win_testing_applocker_filepath: []
win_testing_applocker_dirpath:
    - "C:\\Users"
    - "C:\\Program Files"
    - "C:\\Program Files (x86)"
    - "C:\\ProgramData"
    - "C:\\Windows"
    - "C:\\PerfLogs"
    - "C:\\opscode"
    - "C:\\tmp"
    - "{{ win_temp_dir }}"
win_testing_applocker_bypasschecker: true
